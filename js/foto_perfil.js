function iniciar_camara(e){if("LOCALHOST"!=document.domain.toUpperCase())return void alertify.alert("Informacion camara","Solo puede sacar fotos con la PC local con el dominio localhost(url:localhost/proyecto_estudio/)");document.querySelector(".modalDialog").setAttribute("style","display:block;opacity:1;");let o=document.querySelector("#datos_camara");try{navigator.getUserMedia||navigator.mozGetUserMedia||navigator.mediaDevsices.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia?function(){(navigator.getUserMedia||navigator.mozGetUserMedia||navigator.mediaDevices.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia).apply(navigator,arguments)}({video:!0},(function(e){console.log("Permiso concedido"),o.innerText="Permiso concedido.",video.srcObject=e,video.play(),o.innerText=""}),(function(e){console.log("El permiso fue denegado o no se encontro la camara."),o.style.color="red",o.innerText="El permiso fue denegado o no se encontro la camara."})):(o.style.color="red",o.innerText="Lo siento. Tu navegador no soporta esta característica",alert("Lo siento. Tu navegador no soporta esta característica"))}catch(e){"localhost"!=document.domain&&(o.style.color="red",o.innerText="Cambie en su url "+document.domain+" por localhost para que tome la camara local.")}}function foto_base64(){if(console.log(document.querySelector(".modalDialog").style.display),"none"!=document.querySelector(".modalDialog").style.display){video.pause();var e=canvas.getContext("2d");canvas.width=video.videoWidth,canvas.height=video.videoHeight,e.drawImage(video,0,0,canvas.width,canvas.height);var o=canvas.toDataURL();document.querySelector("#id_perfil").setAttribute("src",o),document.querySelector("#foto_base64").value=o,document.querySelector(".modalDialog").setAttribute("style","display:none !important;opacity:0;"),video.play()}}function zoom_foto(e){let o=document.createElement("img"),t=document.createElement("div");t.setAttribute("class","foto_zoom d-flex justify-content-center"),o.setAttribute("src",e.target.src),t.append(o),document.querySelector("body").append(t)}window.addEventListener("click",(function(e){null!=document.getElementsByClassName("foto_zoom")[0]&&document.querySelector("body").removeChild(document.getElementsByClassName("foto_zoom")[0]),video=document.getElementById("video"),canvas=document.getElementById("canvas"),"tomar_foto"==e.target.id&&iniciar_camara(e),"id_perfil"==e.target.id&&zoom_foto(e)})),document.addEventListener("keyup",(function(e){null!=document.getElementsByClassName("foto_zoom")[0]&&document.querySelector("body").removeChild(document.getElementsByClassName("foto_zoom")[0]),84==e.keyCode&&foto_base64(),27==e.keyCode&&document.querySelector(".modalDialog").setAttribute("style","display:none !important;opacity:0;")})),document.addEventListener("change",(function(e){if("fotoPerfil"==e.target.id){var o=e.target.files[0],t=new FileReader;"image/png"==o.type||"image/jpeg"==o.type||"image/jpg"==o.type?(t.readAsDataURL(o),t.onload=function(){document.querySelector("#id_perfil").setAttribute("src",t.result),document.querySelector("#foto_base64").value=t.result},t.onerror=function(e){console.log("Error: ",e)}):alertify.alert("Datos del alumno/a","Solo se admite formato image/png, image/jpeg o image/jpg.")}}));const obtenerDispositivos=()=>navigator.mediaDevices.enumerateDevices();function camaras(e){navigator.mediaDevices.enumerateDevices().then((e=>{const o=[];e.forEach((e=>{"videoinput"===e.kind&&o.push(e)})),console.log(o),o.length>0&&o.forEach((e=>{const o=document.createElement("option");o.value=e.deviceId,o.text=e.label,document.querySelector("camaras").appendChild(o)}))}))}